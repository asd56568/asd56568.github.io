<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>高等数学期中考试诚信守则确认系统</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', Arial, sans-serif; background-color: #f5f5f5; line-height: 1.8; }
        .container { max-width: 900px; margin: 20px auto; background: white; border-radius: 10px; box-shadow: 0 4px 6px rgba( 0, 0, 0, 0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #1a56db 0%, #1e3a8a 100%); color: white; text-align: center; padding: 30px 20px; }
        .header h1 { font-size: 24px; margin-bottom: 10px; }
        .content-section { padding: 30px; }
        .text-content { background: #fafafa; border: 1px solid #e0e0e0; border-radius: 8px; padding: 30px; margin-bottom: 20px; max-height: 500px; overflow-y: auto; font-size: 16px; }
        .text-content h3 { color: #1e3a8a; text-align: center; margin-bottom: 25px; font-size: 22px; padding-bottom: 15px; border-bottom: 2px solid #e0e0e0; }
        .text-content h4 { color: #1a56db; margin: 20px 0 15px 0; font-size: 18px; padding-left: 10px; border-left: 4px solid #1a56db; }
        .text-content p { margin-bottom: 15px; color: #444; text-indent: 2em; line-height: 1.8; }
        .text-content strong { color: #dc2626; font-weight: 600; }
        .read-complete-btn { display: block; width: 240px; margin: 30px auto 20px; padding: 14px 24px; background: #1a56db; color: white; border: none; border-radius: 6px; font-size: 17px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .read-complete-btn:hover { background: #1e40af; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .signature-section { display: none; text-align: center; padding: 20px 0; }
        .signature-title { color: #333; margin-bottom: 25px; font-size: 21px; }
        .signature-area { border: 2px dashed #94a3b8; border-radius: 8px; margin: 20px auto; background: #f8fafc; width: 90%; max-width: 650px; }
        #signatureCanvas { display: block; margin: 0 auto; cursor: crosshair; border-radius: 6px; }
        .signature-controls { margin: 20px 0; }
        .btn { padding: 10px 22px; margin: 0 12px; border: none; border-radius: 6px; cursor: pointer; font-size: 15px; transition: all 0.3s; font-weight: 500; }
        .clear-btn { background: #ef4444; color: white; }
        .clear-btn:hover { background: #dc2626; }
        .submit-section { display: none; text-align: center; padding: 40px 20px; }
        .confirmation-message { background: #dcfce7; color: #166534; padding: 25px; border-radius: 8px; margin-bottom: 30px; border: 1px solid #bbf7d0; font-size: 17px; }
        .final-submit-btn { background: #16a34a; color: white; padding: 16px 50px; font-size: 19px; border-radius: 8px; font-weight: 600; }
        .final-submit-btn:hover { background: #15803d; transform: scale(1.05); }
        .step-indicator { display: flex; justify-content: center; margin-bottom: 35px; padding: 0 20px; }
        .step { display: flex; align-items: center; margin: 0 25px; }
        .step-circle { width: 32px; height: 32px; border-radius: 50%; background: #e2e8f0; color: #64748b; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; font-size: 16px; }
        .step.active .step-circle { background: #1a56db; color: white; }
        .step.completed .step-circle { background: #16a34a; color: white; }
        .step span { font-size: 16px; color: #475569; }
        .step.active span { color: #1a56db; font-weight: 500; }
        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 9999; color: white; font-size: 20px; }
        @media (max-width: 768px) { .container { margin: 10px; } .text-content { padding: 20px 15px; max-height: 400px; } .step { margin: 0 10px; } .step span { font-size: 14px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>高等数学期中考试诚信守则确认系统</h1>
            <p>请仔细阅读守则内容并完成签字确认</p>
        </div>

        <div class="step-indicator">
            <div class="step active" id="step1">
                <div class="step-circle">1</div>
                <span>阅读守则</span>
            </div>
            <div class="step" id="step2">
                <div class="step-circle">2</div>
                <span>电子签字</span>
            </div>
            <div class="step" id="step3">
                <div class="step-circle">3</div>
                <span>确认提交</span>
            </div>
        </div>

        <div class="content-section">
            <div class="text-content" id="textContent">
                <h3>华北电力大学控制与计算机工程学院高等数学期中考试诚信守则</h3>
                <p>亲爱的同学们：</p>
                <p>当秋意渐浓，银杏叶铺就校园的金黄，我们迎来了高等数学期中考试的检验时刻。这场考试不仅是对半学期知识积累的复盘，更是对科学精神与人格品质的双重淬炼。为营造风清气正的考试氛围，守护每一位同学的付出与尊严，学院特发布《高等数学期中考试诚信守则》，愿我们以笔为剑、以诚立身，共同书写无愧于心的答卷。</p>
                <h4>一、手机使用规范：工具为学，而非投机之器</h4>
                <p>本次考试允许携带手机，但仅限查看电子试卷，严禁以下行为：</p>
                <p><strong>禁用通讯功能</strong>：关闭微信、QQ、短信等社交软件，退出所有学习类APP；</p>
                <p><strong>禁止拍摄传递</strong>：不得用手机拍摄试卷、草稿纸或答案，更不可通过拍照、录屏等方式向场外传递信息；</p>
                <p><strong>杜绝辅助计算</strong>：禁止使用计算器类APP、数学解题软件或其他智能工具获取解题步骤；</p>
                <p><strong>专注答题场景</strong>：手机需放置于桌面左上角，全程保持屏幕朝下，非查看题目时不得触碰。</p>
                <h4>二、诚信为本：以真才实学，赴青春之约</h4>
                <p>高等数学作为控制与计算机学科的“基石”，其严谨性与逻辑性贯穿专业学习的始终。诚信考试，既是对知识的尊重，更是对未来的负责：</p>
                <p><strong>拒绝侥幸心理</strong>：一道题的抄袭、一个公式的照搬，或许能暂时掩盖漏洞，却会让你在未来的专业挑战中失去底气；</p>
                <p><strong>珍视集体荣誉</strong>：一人作弊，损害的是整个学院的学风；人人守诺，方能铸就“学在电院”的金字招牌；</p>
                <h4>三、考场纪律：细节见品格，规则护公平</h4>
                <p>• 凭学生证/校园卡入场，按指定座位就座，不得擅自调换；</p>
                <p>• 开考15分钟后不得入场，开考60分钟内不得交卷离场；</p>
                <p>• 除必要文具外，其他物品一律放至指定区域；</p>
                <h4>四、违规必究：莫让一时糊涂，毁掉一生清誉</h4>
                <p>学院将以“零容忍”态度严肃处理违规行为：</p>
                <p>• 凡发现作弊行为，一律按《华北电力大学学生违纪处分规定》给予记过及以上处分，取消该课程成绩并记入个人档案；</p>
                <p style="text-align: right; margin-top: 30px; color: #666;">华北电力大学控制与计算机工程学院<br>2025年11月27日</p>
            </div>

            <button class="read-complete-btn" id="readCompleteBtn" onclick="showSignature()">
                我已阅读完毕，进入签字
            </button>

            <div class="signature-section" id="signatureSection">
                <h2 class="signature-title">请在下方区域签署您的姓名</h2>
                <div class="signature-area">
                    <canvas id="signatureCanvas" width="600" height="200"></canvas>
                </div>
                <div class="signature-controls">
                    <button class="btn clear-btn" onclick="clearSignature()">清除签字</button>
                    <button class="btn" style="background: #16a34a; color: white;" onclick="completeSignature()">完成签字</button>
                </div>
            </div>

            <div class="submit-section" id="submitSection">
                <div class="confirmation-message">
                    <h3>✅ 签字完成</h3>
                    <p>您已成功阅读《高等数学期中考试诚信守则》并完成电子签字，请确认提交以完成承诺流程。</p>
                </div>
                <button class="btn final-submit-btn" onclick="finalSubmit()">确认提交承诺</button>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div>提交中... 请稍候</div>
    </div>

    <!-- 1. 引入 LeanCloud JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.1/dist/av-min.js"></script>

    <script>
        let canvas, ctx;
        let isDrawing = false;
        let hasSignature = false;

        // ==========================================
        // 2. LeanCloud 配置 (已填入您的 ID 和 Key)
        // =====
